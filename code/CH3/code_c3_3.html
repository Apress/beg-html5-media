<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Beginning HTML5 media: chapter 3: example 3</title>
    <link rel="stylesheet" media="screen" href="style.css" type="text/css"/>
  </head>

  <body>
    <div class="container">
      <h1>Chapter 3: example 3</h1>

      <video controls autoplay width="400">
        <source src="video/HK_Traffic.mp4" type="video/mp4">
        <source src="video/HK_Traffic.webm" type="video/webm">
      </video>
      
      <p>duration on load: <span id="duration_first"></span>.</p>
      <p>duration after loadedmetadata: <span id="duration_loadedmetadata"></span>.</p>
      <p>duration after durationchange: <span id="duration_durationchange"></span>.</p>
      <p>duration after ended: <span id="duration_ended"></span>.</p>
    </div>

    <script type="text/javascript">
      var video = document.getElementsByTagName("video")[0];
      var span1 = document.getElementById("duration_first");
      var span2 = document.getElementById("duration_loadedmetadata");
      var span3 = document.getElementById("duration_durationchange");
      var span4 = document.getElementById("duration_ended");

      span1.innerHTML = video.duration;

      function span2Update(evt) {  span2.innerHTML = video.duration; }
      function span3Update(evt) {  span3.innerHTML = video.duration; }
      function span4Update(evt) {  span4.innerHTML = video.duration; }

      video.addEventListener("loadedmetadata", span2Update, false);
      video.addEventListener("durationchange", span3Update, false);
      video.addEventListener("ended", span4Update, false);
    </script>

  </body>
</html>